'use strict';

var fs = require('fs'),
    path = require('path'),
    xmlReader = require('./lib');

var FILE = path.join(__dirname, 'test/xml/simple-iso-8859-1.xml');

xmlReader.readXML(fs.readFileSync(FILE), function(err, data) {
  if (err) {
    console.error(err);
  }

  console.log('Encoding archivo:', data.encoding);
  console.log('Desde archivo:', data.content);
});

var fileStream = fs.createReadStream(FILE);

var decodedXMLStream = fileStream.pipe(xmlReader.createStream());

decodedXMLStream.on('encodingDetected', function(encoding) {
  console.log('Encoding detectado desde stream:', encoding);
});

decodedXMLStream.on('data', function(chunk) {
  console.log('Desde stream', chunk);
});

decodedXMLStream.on('end', function() {
  console.log('termino lectura');
});
